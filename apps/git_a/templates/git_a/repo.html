{% extends "base.html" %}

{% load repositories i18n markup %}

{% block title %}
    {{ repo.working_dir|repo_name }}
{% endblock %}

{% block page_title %}
    {% trans "Repository" %}: {{ repo.working_dir|repo_name }} {% if repo.is_dirty %}<sup class="text-danger">{% trans "dirty" %}</sup>{% endif %}
{% endblock %}

{% block content %}
    <div class="well">
        <h3>{% trans "Status" %}:</h3>
        <p>{{ repo.git.status|linebreaksbr }}</p>
    </div>

    <section>
    <table class="table">
        <tr>
            <th>{% trans "Clone URL" %}:</th>
            <td></td>
        </tr>
        <tr>
            <th>{% trans "Clone command" %}:</th>
            <td></td>
        </tr>
    </table>
    </section>

    <section class="repo_nav">
        <ul class="nav nav-pills" role="tablist">
            <li class="active dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="#"><i class="glyphicon glyphicon-random"></i>&nbsp;&nbsp;{{ repo.head }}  <span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    {% for head in repo.heads %}
                        <li><a href="#commits_log" role="tab" data-toggle="tab">{{ head.name }}</a></li>
                    {% endfor %}
                </ul>
            </li>
            <li><a href="#tree_index" role="tab" data-toggle="tab"><i class="glyphicon glyphicon-list"></i> {% trans "File Tree" %}</a></li>
        </ul>
    </section>

    <section class="tab-content">
        <div class="tab-pane active" id="commits_log">
            {% for commit_log in commits %}
            {% include 'git_a/commit_header.html' with commit=commit_log repo_name=repo.working_dir|repo_name %}
            {% endfor %}
        </div>
        <div class="tab-pane" id="tree_index">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th style="width: 60px">{% trans "Bytes" %}</th>
                        <th>{% trans "Name" %}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for tree in tree_index %}
                        <tr>
                            <td>{{ tree.size }}</td>
                            <td style="color: #808080">
                                {% if tree.type == 'blob' %}
                                    <span class="glyphicon glyphicon-file"></span>
                                    <a href="{% url 'object_details' repo_name=repo.working_dir|repo_name object_hash=tree.hexsha %}">{{ tree.name }}</a>
                                {% else %}
                                    <span class="glyphicon glyphicon-folder-close"></span>
                                    <a href="{% url 'repository_navigate' repo_name=repo.working_dir|repo_name tree_hash=tree.hexsha %}">{{ tree.name }}</a>
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </section>
{% endblock %}